# OneDriveUpdater DLL Sideloading and SigFlip  

Source Code of version.dll to be used for OneDriveUpdater.exe DLL Sideloading.  

**version.cpp** is a modified version of version_pragma.c generated by [SharpDllProxy](https://github.com/Flangvik/SharpDllProxy).  

Once the version.dll is loaded it retrieves the shellcode from default.dll.  

[SigFlip](https://github.com/med0x2e/SigFlip) was used to hide the shellcode inside default.dll.  

For more details, check my [blog post](https://www.mqsec.me/2023/01/19/onedriveupdater-dll-sideloading-sigflip/).  

## Compile
> cl /EHsc /nologo /LD version.cpp Helper.cpp  

## Credits  
+ [Palo Alto Network's Blog Post](https://unit42.paloaltonetworks.com/brute-ratel-c4-tool/#Modification-of-Versiondll)  
+ [Sunggwan Choi's Blog Post](https://blog.sunggwanchoi.com/recreating-an-iso-payload-for-fun-and-no-profit/)  
+ [SigFlip](https://github.com/med0x2e/SigFlip) by [Mohamed El Azaar](https://twitter.com/med0x2e)  
+ [SharpDllProxy](https://github.com/Flangvik/SharpDllProxy) by [Flangvik](https://twitter.com/Flangvik)
